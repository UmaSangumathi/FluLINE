# Influenza-Analysis-pipeline
FluLine.py is a wrapper script for processing fastq sequencing files from IonTorrent or Illumina. The pipeline does the steps (i), (iv), (v), (vi) and (vii) explained below.  

The main steps in the pipeline are 
- i) Filtering of the sequencing reads by cutadapt and FastQC__ 
  Quality filter with quality 20 and minimum length 50bp.__
  code = /bin/run_QC.sh__

- ii) Find the nearest sequence in NCBI database for each read__
 -- Download the NCBI database locally (ftp://ftp.ncbi.nlm.nih.gov/blast/db/). If the nearest reference genome is unknown, then use "/bin/FindSpeciesInSample.py" to generate a XML file with the Blast of all sequence reads against the NCBI database__
 -- code = bin//bin/FindSpeciesInSample.py [This is not included in the pipeline, run seperately]__
 
- iii) Cluster and identify the viral species, __
 -- MEGAN5 (http://ab.inf.uni-tuebingen.de/software/megan5/) can be used to view the XML file generated by the blast of each read against the NCBI database  __

- iv) Generate consensus genomic sequence iteratively__
 -- VIPR pipeline is used to iteratively get the consensus. The iterative mapping is done by BWA and the consensus is based on the maximum occurance of the nucleotide at a given position__
 -- code = bin/GenerateConsensusGenome_withBlast.py__
 
- v) Map the reads to the final consensus genome__
  -- Uses Bowtie2 to map reads to the consensus genome__
  
- vi) Identify SNVs and __
  -- Uses Lofreq2 to identify the SNVs (genome positions should atleadt have 100 reads mapped)__
  __
- vii) Visualize the coverage of the genome __
  -- Circos plot is used to visualize the different segments of Influenza__
  -- code = bin/createGraphfiles-full.py__


